
<!DOCTYPE html>
<html>
<head>
    <title>LG Task Management Console</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 40px 0 0 0; /* Change the top padding here */
            background-color: #f5f5f5;
            text-align: center;
            animation: fade-up 2s ease;
        }

        h1 {
            margin-bottom: 2rem;
            color: #444;
            font-weight: 600;
            margin: 0 0 60px 0;
        }

        #status {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            grid-gap: 2rem;
            width: 80%;
            margin-bottom: 2rem;
        }

        .user-bar {
            display: flex;
            align-items: center;
            margin: 60px 0 10px 20px;  /* top, right, bottom, left */
            padding: 0.6rem;  /* smaller padding, less height */
            background-color: white;
            border-radius: 50px;
            box-shadow: 0px 10px 15px rgba(0, 0, 0, 0.05);
            animation: fade-up 2s ease;
        }


        .user-avatar {
            width: 100px;
            height: 50px;
            border-radius: 50%;
            background-color: #ccc;
            margin-right: 1rem;
        }

        .status-text {
            color: #aaa;
        }

        button {
            padding: 1rem 2rem;
            border: none;
            border-radius: 12px;
            background-color: #007BFF;
            color: white;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0px 10px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Status Colors */
        .status-green {
            border-left: 5px solid #6abf69;
        }

        .status-orange {
            border-left: 5px solid #ffa500;
        }

        .status-red {
            border-left: 5px solid #ff5a5a;
        }

        .disclaimer {
            margin-top: 50px;
            font-size: 14px;
            padding: 0 20px;
            color: #666;
            text-align: center;
            animation: fade-up 5s ease;
        } 

        @keyframes fade-up {
            0% {
               opacity: 0;
               transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #lastUpdated {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #333;
            font-size: 14px;
        }

    </style>
</head>
<body>
    <h1>LG Task Management Console</h1>
    <button onclick="fetchStatus()">Refresh Status</button>
    <div id="lastUpdated"></div>
    <div class="status" id="status"></div>
    <script>
        function fetchStatus() {
            fetch('http://10.27.0.24:3000/m5-status')
            .then(response => response.json())
            .then(data => {
                let statusDiv = document.getElementById('status');
                statusDiv.innerHTML = '';

                let currentTime = Date.now();
                let lastUpdated = new Date(currentTime).toLocaleString();
                document.getElementById('lastUpdated').textContent = "Last Updated: " + lastUpdated;

                for (let userid in data) {
                    let userDiv = document.createElement('div');
                    let currentTime = Date.now();

                    let status = data[userid].status;
                    if (currentTime - data[userid].timestamp > 10 * 60 * 1000) { // 10 minutes
                        status = 'offline';
                    }

                    userDiv.classList.add('user-bar');
                    if (status === 'ontask') {
                        userDiv.classList.add('status-green');
                    } else if (status === 'grace') {
                        userDiv.classList.add('status-orange');
                    } else if (status === 'offtask') {
                        userDiv.classList.add('status-red');
                    }

                    userDiv.innerHTML = `
                        <div class="user-avatar" style="background-image: url('http://example.com/path/to/avatar/${userid}.jpg');"></div>
                        <div class="user-info">
                            <span class="user-id"><strong>User:</strong> ${userid}</span>
                            <span class="status-text"><strong>Status:</strong> ${status}</span>
                        </div>`;
                    statusDiv.appendChild(userDiv);
                }
            })
            .catch(error => console.error('Error:', error));
        }

        fetchStatus();
        setInterval(fetchStatus, 30 * 1000);  // Refresh status every minute
    </script>
    <p class="disclaimer">Please note that all the data on this site is subject to terms and conditions. Your use of this site constitutes your agreement to abide by these terms. Some Data may take 1-2 seconds to update, depending on how many users are currently using the system. Please note that The students' status ONLY updates when info is sent from the student. This means that if the student has been on task for 10 minutes, it will show "on task" for those 10 minutes. Please note that this is normal. If you find a bug or glitch in the system, or have any question regarding the system and its usage, please visit this website for the manual: 'https://github.com/mathieufitzgerald/lg-task-monitor', or contact mat at: info@matfit.ch</p>
</body>
</html>

